<div
  class="page-bg"
  [style.background-image]="
    backgroundImage ? 'url(' + backgroundImage + ')' : 'none'
  "
></div>
<div class="page-bg-overlay"></div>

<div
  class="remote-control"
  [style.background-image]="
    backgroundImage ? 'url(' + backgroundImage + ')' : 'none'
  "
>
  <!-- Top Row: Back, Home, Info, Context Menu, Playlist -->
  <div class="auxiliary-controls top-row">
    <ion-button fill="clear" color="dark" (click)="onBack()">
      <ion-icon slot="icon-only" name="arrow-back-outline" />
    </ion-button>
    <ion-button fill="clear" color="dark" (click)="onGoHome()">
      <ion-icon slot="icon-only" name="home-outline" />
    </ion-button>
    <ion-button fill="clear" color="dark" (click)="onShowInfo()">
      <ion-icon slot="icon-only" name="information-circle-outline" />
    </ion-button>
    <ion-button fill="clear" color="dark" (click)="onContextMenu()">
      <ion-icon slot="icon-only" name="ellipsis-horizontal" />
    </ion-button>
    <ion-menu-toggle>
      <ion-button fill="clear" color="dark">
        <ion-icon slot="icon-only" name="reorder-three-outline" />
      </ion-button>
    </ion-menu-toggle>
  </div>
  <!-- Now Playing -->
  @if (currentTrack) {
    <div class="now-playing">
      <div class="now-playing__overlay">
        <div class="now-playing__info">
          @if (currentTrack.thumbnail) {
            <img
              class="now-playing__thumb"
              [src]="currentTrack.thumbnail | assets"
              [alt]="currentTrack.title"
            />
          }
          <div class="now-playing__text ion-text-dark">
            <h3 class="now-playing__title">{{ currentTrack.title }}</h3>
            @if (currentTrack.type === "song") {
              <p class="now-playing__subtitle">
                {{ currentTrack.artist | arrayToString }}
                @if (currentTrack.album) {
                  <span> Â· {{ currentTrack.album }}</span>
                }
              </p>
            } @else {
              <p class="now-playing__subtitle">
                {{ currentTrack.genre | arrayToString }}
              </p>
            }
          </div>
        </div>

        <!-- Seekbar -->
        <div class="now-playing__seekbar">
          <span class="now-playing__time">
            @if (showHours) {
              {{ currentHours }}:
            }
            {{ currentMinutes | zeroPadding }}:{{
              currentSeconds | zeroPadding
            }}
          </span>

          <ion-range
            class="now-playing__range"
            [value]="seekDisplayPercentage"
            (ionKnobMoveStart)="onSeekStart()"
            (ionKnobMoveEnd)="onSeekEnd($event)"
          />

          <span class="now-playing__time">
            @if (showHours) {
              {{ totalHours }}:
            }
            {{ totalMinutes | zeroPadding }}:{{ totalSeconds | zeroPadding }}
          </span>
        </div>
      </div>
    </div>
  }

  <!-- D-Pad Navigation -->
  <div class="dpad-container">
    <div class="dpad">
      <!-- Up Button -->
      <button class="dpad-btn dpad-up" (click)="onNavigateUp()">
        <ion-icon name="chevron-up-outline" />
      </button>

      <!-- Left Button -->
      <button class="dpad-btn dpad-left" (click)="onNavigateLeft()">
        <ion-icon name="chevron-back-outline" />
      </button>

      <!-- OK Button (Center) -->
      <button class="dpad-btn dpad-ok" (click)="onSelect()">OK</button>

      <!-- Right Button -->
      <button class="dpad-btn dpad-right" (click)="onNavigateRight()">
        <ion-icon name="chevron-forward-outline" />
      </button>

      <!-- Down Button -->
      <button class="dpad-btn dpad-down" (click)="onNavigateDown()">
        <ion-icon name="chevron-down-outline" />
      </button>
    </div>
  </div>

  <!-- Playback Controls -->
  <div class="playback-controls">
    <ion-button fill="clear" color="dark" (click)="onPrevious()">
      <ion-icon slot="icon-only" name="play-skip-back-outline" />
    </ion-button>
    <ion-button fill="clear" color="dark" (click)="onPlayPause()">
      <ion-icon
        slot="icon-only"
        [color]="isPlaying ? 'primary' : 'dark'"
        [name]="isPlaying ? 'pause-outline' : 'play-outline'"
      />
    </ion-button>
    <ion-button fill="clear" color="dark" (click)="onStop()">
      <ion-icon slot="icon-only" name="stop-outline" />
    </ion-button>
    <ion-button fill="clear" color="dark" (click)="onNext()">
      <ion-icon slot="icon-only" name="play-skip-forward-outline" />
    </ion-button>
  </div>

  <!-- Mode Controls -->
  <div class="mode-controls">
    <ion-button
      fill="clear"
      (click)="onRepeat()"
      [color]="getRepeatColor()"
      [disabled]="!canRepeat || partyMode"
    >
      <ion-icon slot="icon-only" [name]="getRepeatIcon()" />
    </ion-button>
    <ion-button
      fill="clear"
      (click)="onShuffle()"
      [color]="shuffled ? 'primary' : 'dark'"
      [disabled]="!canShuffle || partyMode"
    >
      <ion-icon slot="icon-only" name="shuffle-outline" />
    </ion-button>
    <ion-button
      fill="clear"
      (click)="onPartyMode()"
      [color]="partyMode ? 'primary' : 'dark'"
    >
      <ion-icon slot="icon-only" name="beer-outline" />
    </ion-button>
  </div>
</div>
